[gd_scene load_steps=6 format=3 uid="uid://duvuvcyuqptrg"]

[ext_resource type="PackedScene" uid="uid://bov1qert3n6ln" path="res://feature/!world/ui_quick_bar.tscn" id="2_fgr0d"]
[ext_resource type="PackedScene" uid="uid://wq8eaeo5eftd" path="res://feature/ui_content_container/content_container.tscn" id="3_ewsbk"]
[ext_resource type="PackedScene" uid="uid://bt7x31hbxwu7a" path="res://feature/!world/ui_sreens/cm_inventory.tscn" id="4_i7tgh"]
[ext_resource type="PackedScene" uid="uid://yg7wttxvrjwe" path="res://feature/!world/ui_sreens/cm_location.tscn" id="5_hmmlf"]

[sub_resource type="GDScript" id="GDScript_kbdun"]
script/source = "extends CanvasLayer

@export var character: Character

@onready var quick_bar: PanelContainer = %QuickBar
@onready var tab_container: TabContainer = %TabContainer

enum CMKeys{INVENTORY, LOCATION}

@onready var _content_menus := {
	CMKeys.INVENTORY: $\"VBoxContainer/HBoxContainer/TabContainer/CM Inventory\",
	CMKeys.LOCATION: $\"VBoxContainer/HBoxContainer/TabContainer/CM Loacation\",
}

func _ready() -> void:
	var database: Database = load(ProjectSettings.get_setting(\"resource_databases/main_base_path\", \"res://database.gddb\"))
	var local_inv := Game.get_world_screen().get_inventories_controller().get_inventory(\"player\")
	local_inv.add_item(database.fetch_data_string(\"items/primus\"), 1)
	local_inv.add_item(database.fetch_data_string(\"items/water_clear\"), 10)
	local_inv.add_item(database.fetch_data_string(\"items/fresh_meat\"), 15)
	
	quick_bar.button_pressed.connect(tab_container.set_current_tab)
	quick_bar.button_pressed.connect(character.controller._stop)
	tab_container.set_current_tab(-1)
	

func get_content_menu(key: CMKeys):
	return _content_menus
"

[node name="UI" type="CanvasLayer"]
layer = 15
script = SubResource("GDScript_kbdun")

[node name="VBoxContainer" type="VBoxContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/separation = 0

[node name="HBoxContainer" type="HBoxContainer" parent="VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
mouse_filter = 2
theme_override_constants/separation = 0

[node name="QuickBar" parent="VBoxContainer/HBoxContainer" instance=ExtResource("2_fgr0d")]
unique_name_in_owner = true
custom_minimum_size = Vector2(96, 0)
layout_mode = 2

[node name="TabContainer" type="TabContainer" parent="VBoxContainer/HBoxContainer"]
unique_name_in_owner = true
self_modulate = Color(1, 1, 1, 0)
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
current_tab = 0
tabs_visible = false
deselect_enabled = true

[node name="ContentMenu0" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
layout_mode = 2
metadata/_tab_index = 0

[node name="ContentMenu1" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
visible = false
layout_mode = 2
metadata/_tab_index = 1

[node name="ContentMenu2" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
visible = false
layout_mode = 2
metadata/_tab_index = 2

[node name="ContentMenu3" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
visible = false
layout_mode = 2
metadata/_tab_index = 3

[node name="ContentMenu4" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
visible = false
layout_mode = 2
metadata/_tab_index = 4

[node name="ContentMenu5" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("3_ewsbk")]
visible = false
layout_mode = 2
metadata/_tab_index = 5

[node name="CM Inventory" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("4_i7tgh")]
visible = false
layout_mode = 2
transfer_inventory = NodePath("../CM Loacation")
metadata/_tab_index = 6

[node name="CM Loacation" parent="VBoxContainer/HBoxContainer/TabContainer" instance=ExtResource("5_hmmlf")]
visible = false
layout_mode = 2
metadata/_tab_index = 7
